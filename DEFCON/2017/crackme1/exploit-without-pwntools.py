import string
import subprocess

cmd = './crackme'

def test(s):
    child = subprocess.Popen(cmd, stdout=subprocess.PIPE, stdin=subprocess.PIPE)
    child.communicate(s)
    return child.returncode

if __name__ == '__main__':
    s = ""
    prev_r = test(s)
    found = False
    while not found:
        for c in string.printable:
            r = test(s + c)
            if r != prev_r:
                s += c
                prev_r = r
                if r == 0:
                    found = True
                break
        print(s)
    print(s)


