#!/usr/bin/env python

from pwn import *

context.clear(arch='i386')

# dummpy binary
binary = ELF.from_assembly('add esp, 0x10; ret')
binary.symbols = {'read': 0xdeadbeef, 'write': 0xdecafbad, 'exit': 0xfeedface}

rop = ROP(binary)


rop.raw(0)
rop.raw(unpack('abcd'))
rop.raw(2)

print "rop.dump is \n{}".format(rop.dump())

rop.call('read', [4,5,6])
print "rop.dump is \n{}".format(rop.dump())

